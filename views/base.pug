doctype html
head
  meta(charset='UTF-8')
  meta(http-equiv='X-UA-Compatible' content='IE=edge')
  meta(name='viewport' content='width=device-width, initial-scale=1.0')
  meta(name="color-scheme" content="light")
  title Instagram
  link(rel='stylesheet' href='/css/styles.css')
  link(rel='icon' href='/images/Instagram_icon.png')
  link(rel='stylesheet' href='https://cdn-uicons.flaticon.com/uicons-regular-rounded/css/uicons-regular-rounded.css')
  link(rel='stylesheet', href='https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.9/cropper.min.css')
.restrict
    div This can be seen only on screens above 1300 pixels width
.appcontainer
    if inbox===true
        .inboxcontainer
            .msgsidepop
                .navbar
                    a(href='/')
                        img(width='27', src="/images/instaicon.png", class="apptext apptexticon")    
                    a(href='/')
                        .navitem
                            img(width='27' height='27' src='https://img.icons8.com/fluency-systems-filled/48/home.png' alt='home')
                    .navitem.searchnavbtn
                        img(width='27' height='27' src='https://img.icons8.com/ios-glyphs/100/search--v1.png' alt='search--v1')
                    a(href='/explore')
                        .navitem
                            img(width='27' height='27' src='https://img.icons8.com/ios/50/compass--v1.png' alt='compass--v1')
                    a(href='')
                        .navitem
                            img(width='27' height='27' src='https://img.icons8.com/ios/50/instagram-reel.png' alt='instagram-reel')
                    a(href='/direct/inbox')
                        .navitem.msgsnavbtn
                            img(width='27' height='27' src='https://img.icons8.com/ios/50/telegram-app.png' alt='telegram-app')
                    .navitem.notifnavbtn
                        img(width='27' height='27' src='https://img.icons8.com/ios/50/like--v1.png' alt='like--v1')
                    .navitem.postcreatenavbtn
                        img(width='27' height='27' src='https://img.icons8.com/ios/50/plus--v1.png' alt='plus--v1')
                    a(href=`/${userloggedin.username}`)
                        .navitem
                            .prof.userprof
                                img(src=userloggedin.profilePic, alt="")
                    .navitem.moreicon
                        img(width='26' height='26' src='https://img.icons8.com/ios-filled/50/menu--v1.png' alt='menu--v1')
                .subcontainer
                    .msgheader.msgheader1
                        p.username
                            | #{userloggedin.username} 
                            img(width='20', height='20', src='https://img.icons8.com/ios/50/expand-arrow--v2.png', alt='expand-arrow--v2')
                        img(width='27', height='27', src='https://img.icons8.com/ios/50/goodnotes.png', alt='goodnotes' class='msgpopbtn')
                    .msgheader
                        p Messages
                        p Requests
                    .chatscontainer
            .msgscontainer
                if msgs===true
                    .user.top
                        if chat.isgroupchat===true
                            .prof.grpprof.grpprof1
                                    img(src=chat.users[0].profilePic, alt='')
                            .prof.grpprof.grpprof2
                                img(src=chat.users[1].profilePic, alt='')
                            -users = chat.users.filter(user => user._id != userloggedin._id)
                            -usernames = users.map(user => user.username)
                            -usernames = usernames.join(', ');
                            div
                                .pagename #{usernames}
                        else
                            -user = chat.users.filter(user => user._id != userloggedin._id)
                            .prof
                                img(src=user[0].profilePic, alt='')
                            div
                                .pagename #{user[0].username}
                                .username #{user[0].name}
                        .bluebtn
                            img(width='27', height='27', src='https://img.icons8.com/ios/50/phone--v1.png', alt='phone--v1')
                            img(width='27', height='27', src='https://img.icons8.com/ios/50/video-call.png', alt='video-call')
                            img(width='27 ', height='27', src='https://img.icons8.com/ios/50/info--v1.png', alt='info--v1')
                    .middle
                        .middlehead
                            if chat.isgroupchat===true
                                .prof.grpprof1
                                    img(src=chat.users[0].profilePic, alt='')
                                .prof.grpprof2
                                    img(src=chat.users[1].profilePic, alt='')
                                .username #{usernames} 
                            else
                                .prof
                                    img(src=user[0].profilePic, alt='')
                                .username #{user[0].username}
                                .name #{user[0].name}
                                .editbtn View profile
                        .msgsholder
                    .bottom(data-chatid=chat._id)
                        .commentinputbox
                            img(width='32', height='32', src='https://img.icons8.com/emoji/48/smiling-face-with-smiling-eyes.png', alt='smiling-face-with-smiling-eyes')
                            textarea.commentinput.msginput(id='', rows='1', placeholder='Add a comment...')
                            span.msgsendbtn Post
                            img.inputbased(width='27', height='27', src='https://img.icons8.com/material-rounded/24/microphone.png', alt='microphone')
                            img.inputbased(width='29', height='29', src='https://img.icons8.com/sf-regular/48/gallery.png', alt='gallery')
                            img.inputbased(width='27', height='27', src='https://img.icons8.com/ios/50/like--v1.png', alt='like--v1')
                else
                    .nopostscontainer
                        img(width='80', height='80', src='https://img.icons8.com/external-prettycons-flat-prettycons/47/external-messenger-social-media-prettycons-flat-prettycons.png', alt='external-messenger-social-media-prettycons-flat-prettycons')
                        .boldone
                            h1 Your messages
                        div Send private photos and messages to a friend or group
                        .blue.msgpopbtn Send message
    else
        .navbar
            //- img.appicon.apptexticon(width='27' height='27' src='https://img.icons8.com/ios-filled/50/instagram-new--v1.png' alt='instagram-new--v1')
            a(href='')
                img.apptext.apptexticon(src='/images/insttext.png' alt='' width='97px')
            a(href='/')
                .navitem
                    img(width='27' height='27' src='https://img.icons8.com/fluency-systems-filled/48/home.png' alt='home')
                    span Home
            .navitem.searchnavbtn
                img(width='27' height='27' src='https://img.icons8.com/ios-glyphs/100/search--v1.png' alt='search--v1')
                span Search
            a(href='/explore')
                .navitem
                    img(width='27' height='27' src='https://img.icons8.com/ios/50/compass--v1.png' alt='compass--v1')
                    span Explore
            a(href='')
                .navitem
                    img(width='27' height='27' src='https://img.icons8.com/ios/50/instagram-reel.png' alt='instagram-reel')
                    span Reels
            a(href='/direct/inbox')
                .navitem.msgsnavbtn
                    img(width='27' height='27' src='https://img.icons8.com/ios/50/telegram-app.png' alt='telegram-app')
                    span Messages
            .navitem.notifnavbtn
                img(width='27' height='27' src='https://img.icons8.com/ios/50/like--v1.png' alt='like--v1')
                span Notifications
            .navitem.postcreatenavbtn
                img(width='27' height='27' src='https://img.icons8.com/ios/50/plus--v1.png' alt='plus--v1')
                span Create
            a(href=`/${userloggedin.username}`)
                .navitem
                    //- img(width='27' height='27' src='https://img.icons8.com/ios-filled/50/user-male-circle.png' alt='user-male-circle')
                    .prof.userprof
                        img(src=userloggedin.profilePic, alt="")
                    span Profile
            .navitem.moreicon
                img(width='26' height='26' src='https://img.icons8.com/ios-filled/50/menu--v1.png' alt='menu--v1')
                span More
        .maincontainer
            block content
        block post

    .sidepop.hidden
        .navbar
            a(href='/')
                img(width='27', src="/images/instaicon.png", class="apptext apptexticon")
            a(href='/')
                .navitem
                    img(width='27' height='27' src='https://img.icons8.com/fluency-systems-filled/48/home.png' alt='home')
            .navitem.searchnavbtn
                img(width='27' height='27' src='https://img.icons8.com/ios-glyphs/100/search--v1.png' alt='search--v1')
            a(href='/explore')
                .navitem
                    img(width='27' height='27' src='https://img.icons8.com/ios/50/compass--v1.png' alt='compass--v1')
            a(href='')
                .navitem
                    img(width='27' height='27' src='https://img.icons8.com/ios/50/instagram-reel.png' alt='instagram-reel')
            a(href='/direct/inbox')
                .navitem.msgsnavbtn
                    img(width='27' height='27' src='https://img.icons8.com/ios/50/telegram-app.png' alt='telegram-app')
            .navitem.notifnavbtn
                img(width='27' height='27' src='https://img.icons8.com/ios/50/like--v1.png' alt='like--v1')
            .navitem.postcreatenavbtn
                img(width='27' height='27' src='https://img.icons8.com/ios/50/plus--v1.png' alt='plus--v1')
            a(href=`/${userloggedin.username}`)
                .navitem
                    //- img(width='27' height='27' src='https://img.icons8.com/ios-filled/50/user-male-circle.png' alt='user-male-circle')
                    .prof.userprof
                        img(src=userloggedin.profilePic, alt="")
            .navitem.moreicon
                img(width='26' height='26' src='https://img.icons8.com/ios-filled/50/menu--v1.png' alt='menu--v1')
        .subcontainer.subcontainer2  
    
    .poppostcontainer
        .popcontentholder
        i.fi.fi-rr-cross-small.cross
    .poppostcontainer1
        .popcontentholder1
        i.fi.fi-rr-cross-small.cross1
.loading
  img(src=`../../images/spin.gif` width='150px' alt='')
script.
    var userloggedin = !{userloggedinJs}
script(src='https://code.jquery.com/jquery-3.7.0.min.js' integrity='sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=' crossorigin='anonymous')
script(src='https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.9/cropper.min.js')
script(src="https://cdn.socket.io/4.6.0/socket.io.min.js" integrity="sha384-c79GN5VsunZvi+Q/WObgk2in0CbZsHnjEqvFxC5DxHn9lTfNce2WW6h2pH6u/kF+" crossorigin="anonymous")
script(type="text/JavaScript" src = "https://cdn.jsdelivr.net/npm/lodash@4.17.20/lodash.min.js")
script(src="/js/socket.js")
script(src='/js/functioning.js')
if profile === true
    script.
        var profuser = !{profuserJs}
    script(src='../js/profile.js')
if inbox===true 
    script(src='/js/chats.js')
if msgs===true
    script.
        var chat = !{chatinJs}
    script(src='/js/messages.js')

